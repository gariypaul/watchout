<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Item - My Simple Website</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        header,
        .container,
        footer {
            padding: 15px;
        }

        footer {
            margin-top: 20px;
            text-align: center;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .form-control {
                width: 100%;
                /* Full width on small screens */
                margin-bottom: 10px;
                /* Spacing after each input on smaller screens */
            }

            .form-control:not(textarea) {
                max-width: 300px;
                /* Limiting width for non-textarea inputs on small screens */
            }
        }

        /* Limit input field width for larger screens */
        .form-control:not(textarea) {
            max-width: 400px;
            /* Adjust this value as needed */
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">

    </nav>
    <section class="container">
        <h2 class="text-center mb-4">Add a New Watch Listing</h2>
        <form id="watchForm">
            <div class="mb-3">
                <label for="watchName" class="form-label">Watch Name</label>
                <input type="text" class="form-control" id="watchName" placeholder="Enter watch name" required>
            </div>
            <div class="mb-3">
                <label for="watchPrice" class="form-label">Price</label>
                <input type="number" class="form-control" id="watchPrice" placeholder="Enter price" required>
            </div>
            <div class="mb-3">
                <label for="watchSize" class="form-label">Size</label>
                <input type="text" class="form-control" id="watchSize" placeholder="Enter size" required>
            </div>
            <div class="mb-3">
                <label for="watchMaterial" class="form-label">Material</label>
                <input type="text" class="form-control" id="watchMaterial" placeholder="Enter material" required>
            </div>
            <div class="mb-3">
                <label for="watchDescription" class="form-label">Description</label>
                <textarea class="form-control" id="watchDescription" rows="5" placeholder="Enter a detailed description"
                    required></textarea>
            </div>
            <div class="mb-3">
                <label for="watchImage" class="form-label">Watch Image</label>
                <input type="file" class="form-control" id="watchImage" required>
            </div>
            <div class="text-center">
                <button type="submit" class="btn btn-primary">Submit</button>
            </div>
        </form>
    </section>
    <footer class="bg-light">
        &copy; 2023 My Website. All rights reserved.
    </footer>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js";
        import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-database.js";
        import { getStorage, ref as storageRef, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-storage.js";

        const firebaseConfig = {
            apiKey: "AIzaSyATTLXHrjxowvjDwokc8unc1bOc6veqdCw",
            authDomain: "watchout-84cc5.firebaseapp.com",
            databaseURL: "https://watchout-84cc5-default-rtdb.firebaseio.com",
            projectId: "watchout-84cc5",
            storageBucket: "watchout-84cc5.appspot.com",
            messagingSenderId: "73851933764",
            appId: "1:73851933764:web:54b79f1c6137923196d811"
        };
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const storage = getStorage(app);

        document.getElementById('watchForm').addEventListener('submit', (e) => {
            e.preventDefault();

            // Get form values
            const watchName = document.getElementById('watchName').value;
            const watchPrice = document.getElementById('watchPrice').value;
            const watchSize = document.getElementById('watchSize').value;
            const watchMaterial = document.getElementById('watchMaterial').value;
            const watchDescription = document.getElementById('watchDescription').value;
            const watchImage = document.getElementById('watchImage').files[0];

            // Firebase database reference
            const watchesRef = ref(db, 'watches');
            const newWatchRef = push(watchesRef);

            // Upload image to Firebase Storage
            const storageReference = storageRef(storage, 'watch_images/' + watchImage.name);
            const uploadTask = uploadBytes(storageReference, watchImage);

            uploadTask.then(snapshot => {
                getDownloadURL(snapshot.ref).then(downloadURL => {
                    // Create the watch item in the database
                    set(newWatchRef, {
                        name: watchName,
                        price: watchPrice,
                        size: watchSize,
                        material: watchMaterial,
                        description: watchDescription,
                        imageUrl: downloadURL
                    });

                    // Reset the form after successful submission
                    document.getElementById('watchForm').reset();
                    alert('Watch listing added successfully!');
                });
            }).catch(error => {
                console.error('Error uploading image: ', error);
            });
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>